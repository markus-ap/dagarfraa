on: 
  push:
    branches:
      - hovud
    paths:
      - 'generert/**'
      - '.github/workflow/**'
  workflow_dispatch:

name: 
jobs:
  web-deploy:
    name: 🎉 Last opp vevside
    runs-on: ubuntu-latest
    steps:
    - name: 🚚 Last ned koda
      uses: actions/checkout@v3
    
    - name: 🐍 Sett opp python
      uses: actions/setup-python@v2
      with:
        python-version: "3.x"
    
    - name: 📰 Installér krav
      run: pip install krav.txt
    
    - name: 🏗 Bygg vevsidar
      run: python malar/hovud.py
    
    - name: Commit and push changes
      run: |
        git config --global user.name "GitHub Actions Bot"
        git config --global user.email "action@github.com"
        git add .
        git commit -m "Autogenererte sidar"
        git push
    
    - name: 📂 Synkronisér filar
      uses: SamKirkland/FTP-Deploy-Action@4.3.3
      with:
        server: ftp.domeneshop.no
        username: dagarfra
        password: ${{ secrets.ftp_passord }}
        server-dir: www/
        local-dir: ./generert/
        port: 21
        dangerous-clean-slate: true